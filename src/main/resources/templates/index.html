<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <div th:replace="fragments/layout :: common_header('Mediatron')"></div>
</head>
<body class="bg-neutral-900 text-white">
    <nav th:insert="fragments/layout :: nav"></nav>

    <!-- Hero: фон на всю высоту, справа — карусель постеров -->
    <section id="hero" class="relative w-full h-screen overflow-hidden">
        <div id="hero-bg"
             class="hero-bg"
             th:style="${#lists.isEmpty(movieHero)} ? '' : 'background-image: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.35)), url(' + ${(movieHero.get(0).images != null ? movieHero.get(0).images.backdropPath : movieHero.get(0).backdropPath)} + ')'">
        </div>
        <div class="movie-backdrop-overlay"></div>

        <!-- Левый блок: логотип, мета (год | рейтинг | длительность), описание -->
        <aside id="hero-info"
               class="absolute left-[6vw] top-1/2 -translate-y-1/2 w-[32vw] max-w-[540px] z-[2] pointer-events-auto">
            <div class="hero-info-card p-5 rounded-2xl">
                <!-- Обёртка логотипа: фиксированная область, чтобы логотип не сдвигал содержимое -->
                <div class="hero-logo-wrap w-full mb-3">
                    <img id="hero-info-logo" class="hero-info-logo max-h-[120px] w-auto mx-auto"
                         th:if="${(movieHero != null && !#lists.isEmpty(movieHero)) && (movieHero.get(0).images != null ? movieHero.get(0).images.logoPath : movieHero.get(0).logoPath) != null}"
                         th:src="${movieHero.get(0).images != null ? movieHero.get(0).images.logoPath : movieHero.get(0).logoPath}"
                         alt="logo">
                    <h1 id="hero-info-title" class="text-3xl md:text-4xl font-bold hero-title-main text-center"
                        th:unless="${(movieHero != null && !#lists.isEmpty(movieHero)) && (movieHero.get(0).images != null ? movieHero.get(0).images.logoPath : movieHero.get(0).logoPath) != null}"
                        th:text="${movieHero != null && !#lists.isEmpty(movieHero) ? (movieHero.get(0).title != null ? movieHero.get(0).title : movieHero.get(0).originalTitle) : ''}">Title</h1>
                </div>

                <!-- Контент: мета и описание — не зависит от размера логотипа -->
                <div class="hero-info-content">
                    <!-- Мета: год | возраст | длительность -->
                    <div class="hero-meta flex items-center gap-3 text-sm md:text-base mb-4 justify-start">
                        <span id="hero-info-year" class="hero-meta-item"
                              th:text="${movieHero != null && !#lists.isEmpty(movieHero) ? movieHero.get(0).year : ''}">2024</span>
                        <span class="hero-meta-sep">|</span>
                        <span id="hero-info-age" class="hero-meta-item hero-age-rating"
                              th:text="${movieHero != null && !#lists.isEmpty(movieHero) ? (movieHero.get(0).ageRating != null ? movieHero.get(0).ageRating + '+' : '') : ''}">16+</span>
                        <span class="hero-meta-sep">|</span>
                        <span id="hero-info-runtime" class="hero-meta-item"
                              th:text="${movieHero != null && !#lists.isEmpty(movieHero) ? (movieHero.get(0).runtime != null ? movieHero.get(0).runtime: '') : ''}">120 мин</span>
                    </div>

                    <!-- Описание -->
                    <p id="hero-info-description"
                       class="text-sm md:text-base text-slate-200 leading-relaxed text-left"
                       th:text="${movieHero != null && !#lists.isEmpty(movieHero) ? (movieHero.get(0).description != null ? movieHero.get(0).description : '') : ''}">
                        Описание фильма…
                    </p>
                </div>
            </div>
        </aside>

        <!-- Правая карусель постеров -->
        <div id="hero-carousel" class="hc-wrap">
            <ul id="hero-strip" class="hc-strip">
                <li class="hc-item"
                    th:each="m, iStat : ${movieHero}"
                    th:attr="data-idx=${iStat.index},
                             data-backdrop=${m.images != null ? m.images.backdropPath : m.backdropPath},
                             data-poster=${m.images != null ? m.images.posterPath : m.posterPath},
                             data-title=${m.title != null ? m.title : m.originalTitle},
                             data-logo=${m.images != null ? m.images.logoPath : m.logoPath},
                             data-year=${m.year},
                             data-age=${m.ageRating},
                             data-runtime=${m.runtime},
                             data-description=${m.description}">
                    <button type="button" class="hc-poster-btn" th:aria-label="${m.title != null ? m.title : m.originalTitle}">
                        <img class="hc-poster"
                             th:if="${(m.images != null ? m.images.posterPath : m.posterPath) != null}"
                             th:src="${m.images != null ? m.images.posterPath : m.posterPath}"
                             th:alt="${m.title != null ? m.title : m.originalTitle}" loading="lazy">
                        <div class="hc-poster-fallback"
                             th:unless="${(m.images != null ? m.images.posterPath : m.posterPath) != null}"
                             th:text="${(m.title != null ? m.title : m.originalTitle)?.substring(0,1)}">M</div>
                    </button>
                </li>
            </ul>
        </div>
    </section>

    <script src="/js/hero-carousel.js"></script>
</body>
</html>
